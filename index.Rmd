---
title: "ArticleChicago Floods"
output: html_document
---

<style type="text/css">
.title {
  display: none;
}


</style>

<div class="row" style="padding-top: 0px;"> 
<div class="col-sm-6">

```{r load libraries, echo = FALSE, message = FALSE, warning=FALSE}
library(tidyverse)
library(tidycensus)
library(ggplot2)
library(plotly)
library(scales)
```
```{r Get Data, echo = FALSE,message = FALSE, warning=FALSE, results = 'hide'}
FloodData <- read_csv("ChicagoFloodData.csv") %>%
  mutate(GEOID = as.numeric(AreaCode))

minGEOID <- min(FloodData$GEOID)
maxGEOID <- max(FloodData$GEOID)

CensusData <- get_acs(
  geography = "zcta",
  table = c(race = "B03002"),
  geometry = TRUE,
  cache_table = TRUE) %>% 
  filter(GEOID >= minGEOID & GEOID <= maxGEOID)

ChicagoData <- merge(CensusData, FloodData) 
```
```{r, Clean Data,echo = FALSE, message = FALSE, warning=FALSE, results = FALSE}
ChicagoData <- ChicagoData %>% 
  mutate(Group = case_when(variable == "B03002_003" ~ 'W',
                           variable == "B03002_004" ~ 'BoHL',
                           variable == "B03002_012" ~ 'BoHL',
                           variable == "B03002_001" ~ 'D',
                           variable == "B03002_002" ~ 'D',
                           variable == "B03002_013" ~ 'D',
                           variable == "B03002_014" ~ 'D',
                           variable == "B03002_015" ~ 'D',
                           variable == "B03002_016" ~ 'D',
                           variable == "B03002_017" ~ 'D',
                           variable == "B03002_018" ~ 'D',
                           variable == "B03002_019" ~ 'D',
                           variable == "B03002_020" ~ 'D',
                           variable == "B03002_021" ~ 'D',
                           TRUE ~ 'Other'))

ChicagoDataSummary <- ChicagoData  %>% 
  filter(FloodingLikelihood == 0.2) %>%
  filter(Group != 'D') %>% 
  group_by(Group, GEOID) %>%
  summarize(NumPeople = sum(estimate), 
            PercRisk = mean(PercentAtRisk),
            FloodChance = mean(FloodChance)) %>%
  group_by(GEOID) %>%
  mutate(freq = (NumPeople/sum(NumPeople))*100,
         freq_group = case_when(
           freq >= 0 & freq < 20 ~ "0-20%",
           freq >= 20 & freq < 40 ~ "20-40%",
           freq >= 40 & freq < 60 ~ "40-60%",
           freq >= 60 & freq < 80 ~ "60-80%",
           freq >= 80 & freq <= 100 ~ "80-100%",
           TRUE ~ 'ERROR'
         )) 

ChicagoDataSummary <- ChicagoDataSummary %>%
  filter(Group == 'BoHL')

ChicagoDataSummary$quartile <- ntile(ChicagoDataSummary$FloodChance, 3)
ChicagoDataSummary <- sf::st_cast(ChicagoDataSummary, "MULTIPOLYGON")
```
```{r Plot Themes and Variables,echo = FALSE, message = FALSE, warning=FALSE}

point <- format_format(big.mark = ",", decimal.mark = ".", scientific = FALSE)

FONTFAMILY = "NULL"

font = list(
  size = 12,
  color = "black"
)

label = list(
  bgcolor = "white",
  bordercolor = "black",
  font = font
)

```
# **Flood Risk in Chicago is Higher for Black and Hispanic Communities**
```{r Create Map Plot, echo = FALSE, message = FALSE, warning=FALSE}
MapPlot <- ggplot(data = ChicagoDataSummary, 
                  aes(fill = FloodChance,
                      text = paste("Zip Code:", GEOID,"\n",
                                   "Properties at Risk:", FloodChance,"\n",
                                   "Black or Hispanic Residents:", round(freq),"%"))) +
  geom_sf(color = 'black', size = .3) +
  scale_fill_distiller(palette = "PuBu", direction = 1,
                       breaks = pretty_breaks(),
                       label = comma,
                       limits = c(0, 15000)) +
  labs(title = NULL,
       fill = "Properties\nat Risk") +
  theme_classic() +
  theme(
    legend.title = element_text(size = 10),
    legend.text = element_text(size = 8),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.line = element_blank())

ggplotly(MapPlot, tooltip = c("text")) %>% 
  style(hoverlabel = label) %>%
  layout(
    autosize = F, 
    width = 400, 
    height = 500
  ) %>%
  config(displayModeBar = FALSE,
         showTips = TRUE)
```
Chicago has a problem with property flooding, and it is particularly acute for the city’s black and Hispanic communities. Data from First Street Foundation’s (FSF) Flood Model and the American Community Survey (ACS) show that zip codes with majority black and Hispanic populations have substantially more properties at risk of flooding than anywhere else in the city.

FSF’s Flood Model estimates the annual risk of flood and cost of damage for individual addresses to whole states. Risk assessment is based on independent analysis of rainfall, storm surge, and river data, and by coupling these factors to predict their interactions. The model’s predictions regularly update to account for changing weather patterns, like increases in average precipitation or temperatures. 

To assess for differences in flood risk across Chicago’s communities, the city was broken into its nearly 60 zip codes. Predicted demographic breakdown was obtained from the 2015-2019 ACS. The estimated number of black or Hispanic residents for each zip code were consolidated into one group; the rest of the races and ethnicities were consolidated into the other. 

Using FSF’s methodology, the number of at-risk properties were generated for each zip code. At-risk properties have at least a 1-in-500 chance of annual flooding, yet many of the properties are at greater risk.

Distribution of Chicago Properties With an Annual Flood Risk of at Least 1-in-500
Zip codes were separated into tertiles based on the number of at-risk properties. The upper third shows the zip codes with the most properties at risk.
<br>
<br>
```{r Create Scatter Plot,echo = FALSE, message = FALSE, warning=FALSE}
ScatterPlot <- ggplot(ChicagoDataSummary, 
                      aes(x = freq, 
                          y = FloodChance,
                          fill = FloodChance,
                          color = FloodChance,
                          text = paste("Zip Code:", GEOID,"\n",
                                   "Properties at Risk:", FloodChance,"\n",
                                   "Black or Hispanic Residents:", round(freq),"%"))) +
  geom_point(shape=21, 
             size=4.5) +
  scale_fill_distiller(palette = "PuBu", 
                       direction = 1) +
  scale_color_gradient(guide = FALSE, 
                       low = "grey1", 
                       high = "black") +
  labs(title = "Flood Risk by Chicago Zip Code",
       x = "Black or Hispanic Residents",
       y = "Properties at Risk") +
  scale_x_continuous(labels =  scales::percent_format(scale = 1), 
                     breaks = pretty_breaks()) +
  scale_y_continuous(labels = point, 
                     breaks = pretty_breaks()) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 12, 
                              face = "bold",
                              hjust = .5),
    axis.text = element_text(size = 9),
    axis.title = element_text(size = 11),
    strip.background.x = element_rect("grey90"),
    legend.position = "none")

ggplotly(ScatterPlot, tooltip = "text") %>% 
  style(hoverlabel = label) %>%
  layout(    
    autosize = F, 
    width = 440, 
    height = 440) %>%
  config(displayModeBar = FALSE,
         showTips = TRUE)
```
Communities that have the most properties at risk of flood—those in the upper third of the distribution—are predominately black and Hispanic communities. Conversely, communities that have the fewest properties at risk of flood—the lower third—are communities where black and Hispanic residents are the smallest percentage of the population. In the high-risk category, nearly 40% of the zip codes are estimated to have 80-100% black or Hispanic residents; there are zero communities with 0-20% black or Hispanic residents in the high-risk category. 

A more granular look at flood risk in Chicago shows there is a spectrum of risk for black and Hispanic communities of a magnitude nonexistent in other communities. All communities where the estimated black or Hispanic population is under 20% have less than 2,500 properties at risk. The communities with an estimated black or Hispanic population of over 80% have up to nearly 15,000 properties at risk.

Flooding is an ever more pressing issue for Chicago as precipitation levels over the last five years have summed to produce the city’s wettest half-decade on record. This is an inflection point for a city that was once at the vanguard of civil engineering. Now, the city’s infrastructure cannot keep up.

However, weather pattern changes alone cannot explain the disparate flood risk that separates Chicago’s black and Hispanic communities from the city’s other zip codes. Instead, it has been the city’s history of racist housing policies—redlining, predatory home-mortgage markets, and a panoply of other tactics—that has situated Chicago as a perennial member on lists of America’s most segregated cities. Segregated neighborhoods combined with reduced community investment and lower wages for black and Hispanic workers makes it possible for flooding that is endemic to majority-minority zip codes.

Flooding usually results from inundated sewer systems, reservoirs, and storage tunnels. When the city’s reservoirs and storage tunnels fill with rainwater, excess sewage water seeps into homes as it rises through basement drains. This is a particularly urgent problem for Chicago’s black and Hispanic communities where basements are often rented out as a more affordable housing option. 

Basement flooding has numerous harmful effects. Monetarily, just minor flooding can quickly become expensive—especially for bottom floor residents as basic basement repair costs are conflated with damage to furniture and electronics. However, most egregious is the potential for harmful health effects; sewage-laced water introduces bacteria, mold, and can attract infestations. 

Chicago’s Department of Waste Management (DWM) has been working to reduce the frequency of basement floods in the city. According to the DWM’s website, “The City is working hard to improve our aging infrastructure, but there are 4,400 miles of sewer main in Chicago, and mere replacement is not the answer.  The key is to keep as much water out of the sewer as possible during the heaviest rains.” So, the department is installing rain blockers on street sewer drains in an effort to prevent sewer systems from being overwhelmed. In practice, rain blockers turn streets into temporary water reservoirs, then rainwater enters sewers over many hours instead of rushing in. 

The DWM’s website does not state whether black and Hispanic communities are receiving additional preventative technologies to address the heightened risk they face. 

While it would be possible for the DWM to focus on black and Hispanic communities, they will need residents’ help to fully address the flood causes. This is because the DWM cannot provide preventive technology when water is on private property, and, unfortunately for residents, water on private property is a major source of flood water. Increasingly wet years have antiquated Chicago’s gutter systems. These systems, which guide water to sewage drains, now facilitate basement flooding. “In essence, we are flooding ourselves,” says Chicago’s DWM.

As Chicago’s springs get wetter, concerted efforts between the city and its communities will be necessary to reduce flood risk. However, the city’s solutions will not be equitable if they are uniformly distributed. The data shows that black and Hispanic communities risk property flooding that transcends the risk to the city’s other neighborhoods. Thus, to begin to reduce the risk disparity that currently exists, the city will need to provide additional preventative technology to its black and Hispanic communities.  

Data sources: First Street Foundation’s Flood Factor, US 2015-2019 American Community Survey

</div>
<div class="col-sm-6">


</a>
</div>


</a>
</div>
